<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="OpenXBL" title="OpenXBL" version_string="1.3" version_id="9" url="https://xbl.io" install_callback_class="OpenXBL_Manufacture" install_callback_method="build" uninstall_callback_class="OpenXBL_Manufacture" uninstall_callback_method="destroy">
  <admin_navigation/>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates/>
  <admin_template_modifications/>
  <code_events/>
  <code_event_listeners>
    <listener event_id="criteria_user" execute_order="10" callback_class="OpenXBL_Listener" callback_method="criteriaUser" active="1" hint="" description=""/>
    <listener event_id="load_class_controller" execute_order="10" callback_class="OpenXBL_Listener" callback_method="loadClassController" active="1" hint="" description=""/>
    <listener event_id="template_hook" execute_order="10" callback_class="OpenXBL_Listener" callback_method="templateHook" active="1" hint="" description=""/>
  </code_event_listeners>
  <cron/>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups>
    <group group_id="OpenXBL" display_order="226" debug_only="0"/>
    <option option_id="openxblAPILink" edit_format="select" data_type="unsigned_integer" can_backup="1">
      <default_value>0</default_value>
      <edit_format_params>0={xen:phrase openxbl_use_v1}</edit_format_params>
      <sub_options></sub_options>
      <relation group_id="OpenXBL" display_order="610"/>
    </option>
    <option option_id="openxblDisplayFriends" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>1</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="OpenXBL" display_order="300"/>
    </option>
    <option option_id="openxblDisplayMessageContent" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>0</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="OpenXBL" display_order="400"/>
    </option>
    <option option_id="openxblDisplayMessageInfo" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>1</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="OpenXBL" display_order="410"/>
    </option>
    <option option_id="openxblDisplayProfile" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>1</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="OpenXBL" display_order="420"/>
    </option>
    <option option_id="openxblKey" edit_format="textbox" data_type="string" can_backup="1">
      <default_value></default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="OpenXBL" display_order="1"/>
    </option>
    <option option_id="openxblVisitorSidebar" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>1</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="OpenXBL" display_order="2"/>
    </option>
  </optiongroups>
  <permissions>
    <permission_groups>
      <permission_group permission_group_id="OpenXBL"/>
    </permission_groups>
    <permissions>
      <permission permission_group_id="OpenXBL" permission_id="viewFriends" permission_type="flag" default_value="unset" interface_group_id="OpenXBL" display_order="2"/>
      <permission permission_group_id="OpenXBL" permission_id="viewProfile" permission_type="flag" default_value="unset" interface_group_id="OpenXBL" display_order="1"/>
    </permissions>
    <interface_groups>
      <interface_group interface_group_id="OpenXBL" display_order="1500"/>
    </interface_groups>
  </permissions>
  <phrases>
    <phrase title="openxbl_enter_account_password" version_id="1" version_string="1.0"><![CDATA[Please enter your account password. Not your Microsoft password!]]></phrase>
    <phrase title="openxbl_friends_error" version_id="8" version_string="1.2.1"><![CDATA[We had trouble getting your friends list. Try again later!]]></phrase>
    <phrase title="openxbl_friends_list" version_id="8" version_string="1.2.1"><![CDATA[Friends List]]></phrase>
    <phrase title="openxbl_friends_list_for_x" version_id="8" version_string="1.2.1"><![CDATA[Xbox Live Friends List for {name}]]></phrase>
    <phrase title="openxbl_login_with_xboxlive" version_id="3" version_string="1.1"><![CDATA[Log in with Xbox Live]]></phrase>
    <phrase title="openxbl_no_profile_subtitle" version_id="3" version_string="1.1"><![CDATA[Welcome to Xbox Live!]]></phrase>
    <phrase title="openxbl_signup_with_xboxlive" version_id="1" version_string="1.0"><![CDATA[Signup with Xbox Live]]></phrase>
    <phrase title="openxbl_signup_with_xboxlive_message" version_id="1" version_string="1.0"><![CDATA[You're almost finished! If this is your first time please fill in the form below. If you are migrating to an existing account please select 'Associate Existing Account.']]></phrase>
    <phrase title="openxbl_total_friends" version_id="8" version_string="1.2.1"><![CDATA[Total Friends]]></phrase>
    <phrase title="openxbl_total_friends_online" version_id="8" version_string="1.2.1"><![CDATA[Friends Online]]></phrase>
    <phrase title="openxbl_use_v1" version_id="7" version_string="1.2.1"><![CDATA[Call API Version 1 (/v1/)]]></phrase>
    <phrase title="openxbl_x_has_no_friends_yet" version_id="8" version_string="1.2.1"><![CDATA[{name} has no friends yet!]]></phrase>
    <phrase title="option_group_OpenXBL" version_id="1" version_string="1.0"><![CDATA[OpenXBL]]></phrase>
    <phrase title="option_group_OpenXBL_description" version_id="1" version_string="1.0"><![CDATA[]]></phrase>
    <phrase title="option_openxblAPILink" version_id="7" version_string="1.2.1"><![CDATA[OpenXBL API Version]]></phrase>
    <phrase title="option_openxblAPILink_explain" version_id="7" version_string="1.2.1"><![CDATA[Transmission is cURL HTTPS only! Read GitHub Wiki for why that is.]]></phrase>
    <phrase title="option_openxblDisplayFriends" version_id="8" version_string="1.2.1"><![CDATA[Display Friends List]]></phrase>
    <phrase title="option_openxblDisplayFriends_explain" version_id="8" version_string="1.2.1"><![CDATA[Show a link in the Account Menu]]></phrase>
    <phrase title="option_openxblDisplayMessageContent" version_id="7" version_string="1.2.1"><![CDATA[Display Xbox Live in message content (top right)]]></phrase>
    <phrase title="option_openxblDisplayMessageContent_explain" version_id="7" version_string="1.2.1"><![CDATA[]]></phrase>
    <phrase title="option_openxblDisplayMessageInfo" version_id="7" version_string="1.2.1"><![CDATA[Display Xbox Live in messages sidebar]]></phrase>
    <phrase title="option_openxblDisplayMessageInfo_explain" version_id="7" version_string="1.2.1"><![CDATA[]]></phrase>
    <phrase title="option_openxblDisplayProfile" version_id="7" version_string="1.2.1"><![CDATA[Display Xbox Live in profile]]></phrase>
    <phrase title="option_openxblDisplayProfile_explain" version_id="7" version_string="1.2.1"><![CDATA[]]></phrase>
    <phrase title="option_openxblKey" version_id="1" version_string="1.0"><![CDATA[Application Key]]></phrase>
    <phrase title="option_openxblKey_explain" version_id="1" version_string="1.0"><![CDATA[This should match the Application Key in <a href="https://xbl.io/profile" target="_blank">your account</a> under the Xbox App group.]]></phrase>
    <phrase title="option_openxblVisitorSidebar" version_id="4" version_string="1.2"><![CDATA[Show Visitor Sidebar Login?]]></phrase>
    <phrase title="option_openxblVisitorSidebar_explain" version_id="4" version_string="1.2"><![CDATA[Toggle the 'Log in with Xbox Live' button on the visitor sidebar.]]></phrase>
    <phrase title="permission_group_OpenXBL" version_id="7" version_string="1.2.1"><![CDATA[OpenXBL]]></phrase>
    <phrase title="permission_interface_OpenXBL" version_id="7" version_string="1.2.1"><![CDATA[OpenXBL]]></phrase>
    <phrase title="permission_OpenXBL_viewFriends" version_id="8" version_string="1.2.1"><![CDATA[Can view their Xbox Live friends list]]></phrase>
    <phrase title="permission_OpenXBL_viewProfile" version_id="8" version_string="1.2.1"><![CDATA[Can view Xbox Live profiles]]></phrase>
  </phrases>
  <route_prefixes>
    <route_type type="admin">
      <prefix original_prefix="openxbl" class="OpenXBL_Route_PrefixAdmin_OpenXBL" build_link="all"/>
    </route_type>
    <route_type type="public">
      <prefix original_prefix="openxbl" class="OpenXBL_Route_Prefix_OpenXBL" build_link="data_only"/>
    </route_type>
  </route_prefixes>
  <style_properties/>
  <templates>
    <template title="openxbl_account_menu" version_id="8" version_string="1.2.1"><![CDATA[<xen:if is="{$xenOptions.openxblKey} AND {$xenOptions.openxblDisplayFriends} AND {$visitor.permissions.OpenXBL.viewFriends}">
<li><a href="{xen:link openxbl/friends}" class="OverlayTrigger" data-overlayoptions="{"fixed":false}">{xen:phrase openxbl_friends_list}</a></li>
</xen:if>]]></template>
    <template title="openxbl_footer" version_id="7" version_string="1.2.1"><![CDATA[<xen:if is="{$openxblProfNoJS}">
<xen:require css="openxbl_stats.css" />
</xen:if>

<xen:if is="{$openxblProf}">
<xen:require css="openxbl_profile.css" />
<xen:require js="js/openxbl/ajax/openxblprofile.js" />
<xen:require js="js/openxbl/openxbl.js" />
</xen:if>

<xen:if is="{$openxblProfStats}">
<xen:require css="openxbl_profile_stats.css" />
<xen:require css="openxbl_stats.css" />
<xen:require js="js/openxbl/ajax/openxblprofilestats.js" />
</xen:if>

]]></template>
    <template title="openxbl_friends" version_id="8" version_string="1.2.1"><![CDATA[<xen:require css="openxbl_friends.css" />

<div class="friends" id="friends-{$friends.xuid}">
	<div class="avatar"><img src="{$friends.displayPicRaw}&w=50&h=50" /></div>
	<div class="state"><xen:if is="{$friends.presenceState} == 'Online'">Online</xen:if></div>
	<div class="info">
		<h3 class="title">{$friends.gamertag}</h3>
		<p class="description">{$friends.presenceText}</p>
	</div>
</div>]]></template>
    <template title="openxbl_friends.css" version_id="8" version_string="1.2.1"><![CDATA[.friends
{
	overflow: hidden; zoom: 1;
}

	.friends .avatar
	{
		float: left;
		width: 65px;
		text-align: center;
		font-size: 18pt;
		font-weight: bold;
	}
	
	.friends .state
	{
		float: right;
		font-size: 11px;
		color: {xen:property mutedTextColor};
	}

	.friends .info
	{
		margin-left: 70px;
	}
	
	.friends .info .title
	{
		font-size: 11pt;
		font-weight: bold;
	}
	
	.friends .info .description
	{
		font-size: 11px;
		color: {xen:property mutedTextColor};
	}]]></template>
    <template title="openxbl_helper_login" version_id="5" version_string="1.2"><![CDATA[<xen:if is="{$xenOptions.openxblKey}">
<xen:require css="openxbl_login_bar.css" />
<dl class="ctrlUnit XboxLiveLogin">
	<dt></dt>
	<dd>
		<a href="{xen:link register/openxbl, '', 'reg=1'}" class="xboxLogin" tabindex="110">
			<span>{xen:phrase openxbl_login_with_xboxlive}</span>
		</a>
	</dd>
</dl>
</xen:if>
]]></template>
    <template title="openxbl_login_bar" version_id="4" version_string="1.2"><![CDATA[<xen:if is="{$xenOptions.openxblKey}">
<xen:require css="openxbl_login_bar.css" />
<li>
<a href="{xen:link register/openxbl, '', 'reg=1'}" class="xboxLogin" tabindex="110"><span>{xen:phrase openxbl_login_with_xboxlive}</span></a>
</li>
</xen:if>]]></template>
    <template title="openxbl_login_bar.css" version_id="4" version_string="1.2"><![CDATA[.xboxLogin, #loginBar .xboxLogin {
    display: inline-block;
    width: 180px;
    height: 22px;
    box-sizing: border-box;
    cursor: pointer;
    background-color: #107c10;
    border-radius: 3px;
    padding: 3px;
    text-decoration: none!important;
    color: #FFF !important;
    font-weight: bold;
    font-size: 11px;
    line-height: 14px;
}

.xboxLogin span {
    display: block;
    background: url(styles/openxbl/xbox.png) no-repeat;
    background-position: left 0;
    padding-left: 22px;
    white-space: nowrap;
    overflow: hidden;
}

.sidebar a.xboxLogin
{
    margin: 10px 25px;
}]]></template>
    <template title="openxbl_member_friends" version_id="8" version_string="1.2.1"><![CDATA[<xen:if is="{$visitor.permissions.OpenXBL.viewFriends}">

<xen:title>{xen:phrase openxbl_friends_list_for_x, 'name={$user.username}'}</xen:title>

<xen:container var="$head.noindex">
	<meta name="robots" content="noindex" /></xen:container>

<xen:navigation>
	<xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
</xen:navigation>

<div class="section">
	<xen:if is="{$friends.people}">
		<ol class="overlayScroll">
		<xen:foreach loop="$friends.people" value="$friends">
			<li class="primaryContent">
				<xen:include template="openxbl_friends" />
			</li>
		</xen:foreach>
		</ol>
		<div class="sectionFooter opposedOptions">
			<span class="left">{xen:phrase openxbl_total_friends}: {$numFriends}, {xen:phrase openxbl_total_friends_online}: {$numOnline}</span>
			<div class="right">
				<input type="button" class="button primary overlayOnly OverlayCloser" value="{xen:phrase close}" />
			</div>
		</div>
	<xen:elseif is="{$friends.error}" />
		<div class="primaryContent">{xen:phrase openxbl_friends_error}</div>
		<div class="sectionFooter">
			<input type="button" class="button primary overlayOnly OverlayCloser" value="{xen:phrase close}" />
		</div>
	<xen:else />
		<div class="primaryContent">{xen:phrase openxbl_x_has_no_friends_yet, 'name={$user.username}'}</div>
		<div class="sectionFooter">
			<input type="button" class="button primary overlayOnly OverlayCloser" value="{xen:phrase close}" />
		</div>
	</xen:if>
</div>

</xen:if>]]></template>
    <template title="openxbl_no_xbox_profile" version_id="3" version_string="1.1"><![CDATA[<style>
li {
padding-top:10px;
}
</style>

<xen:title>{xen:phrase openxbl_login_with_xboxlive}</xen:title>

<p>

We could not locate a GamerTag for your account. In order to associate your Xbox Live account you first have to create one.

<ol>
  <li>1. Go to <a href="http://xbox.com" target="_blank">http://xbox.com</a></li>
  <li>2. Login to xbox.com and create a FREE GamerTag</li>
  <li>3. Come back and try to login again!</li>
</ol>

</p>
]]></template>
    <template title="openxbl_profile_member" version_id="7" version_string="1.2.1"><![CDATA[<xen:if is="{$xenOptions.openxblKey} AND {$xenOptions.openxblDisplayProfile}">
	<xen:if is="{$visitor.permissions.OpenXBL.viewProfile} AND {$user.externalAuth.openxbl} > 0">
		<xen:if is="!{$user.is_banned}">
			<div class="openxblprofile" title="{$user.externalAuth.openxbl}"></div>
			<xen:container var="$openxblProf">1</xen:container>
		</xen:if>
	</xen:if>
</xen:if>

    ]]></template>
    <template title="openxbl_profile_message" version_id="7" version_string="1.2.1"><![CDATA[<xen:if is="{$xenOptions.openxblKey} AND {$xenOptions.openxblDisplayMessageContent}">
	<xen:if is="{$visitor.permissions.OpenXBL.viewProfile} AND {$message.externalAuth.openxbl} > 0">
		<xen:if is="!{$message.is_banned}">
			<div class="openxblprofile" style="width: 225px; float: right;" title="{$message.externalAuth.openxbl}"></div>
			<xen:container var="$openxblProf">1</xen:container>
		</xen:if>
	</xen:if>
</xen:if>

]]></template>
    <template title="openxbl_profile_message_info" version_id="7" version_string="1.2.1"><![CDATA[<xen:if is="{$xenOptions.openxblKey} AND {$xenOptions.openxblDisplayMessageInfo}">
	<xen:if is="{$visitor.permissions.OpenXBL.viewProfile} AND {$user.externalAuth.openxbl} > 0">
		<xen:if is="!{$user.is_banned}">
			<div class="openxblprofile" title="{$user.externalAuth.openxbl}"></div>
			<xen:container var="$openxblProf">1</xen:container>
		</xen:if>
	</xen:if>
</xen:if>]]></template>
    <template title="openxbl_sidebar_visitor" version_id="4" version_string="1.2"><![CDATA[<xen:if is="{$xenOptions.openxblKey} AND {$xenOptions.openxblVisitorSidebar}">
<xen:require css="openxbl_login_bar.css" />
<li>
<a href="{xen:link register/openxbl, '', 'reg=1'}" class="xboxLogin" tabindex="110"><span>{xen:phrase openxbl_login_with_xboxlive}</span></a>
</li>
</xen:if>]]></template>
    <template title="openxbl_sidebar_visitor.css" version_id="1" version_string="1.0"><![CDATA[.xbox-side {
background-color: #107c10!important;
}
a.xbox-side:hover {
background-color: #202020!important;
}
div.loginButton .secondaryContent #SignupButton:first-child {
display:none;
}
]]></template>
    <template title="register_openxbl" version_id="1" version_string="1.0"><![CDATA[<xen:title>{xen:phrase openxbl_signup_with_xboxlive}</xen:title>
	
<xen:container var="$openxblSdk">1</xen:container>

<p>{xen:phrase openxbl_signup_with_xboxlive_message}</p>

<form action="{xen:link 'register/openxbl/register'}" method="post" class="xenForm AutoValidator"
	data-fieldValidatorUrl="{xen:link register/validate-field}"
	data-OptInOut="OptIn"
	data-normalSubmit="1"
>

<ul class="tabs Tabs" data-panes="#OpenXBLTabs > li">
	<xen:if is="!{$associateOnly}"><li><a>{xen:phrase create_new_account}</a></li></xen:if>
	<li><a>{xen:phrase associate_existing_account}</a></li>
</ul>

<ul id="OpenXBLTabs">
	
	<xen:if is="!{$associateOnly}">
	<li>
		<dl class="ctrlUnit">
			<dt><label for="ctrl_username">{xen:phrase name}:</label></dt>
			<dd>
				<input type="text" name="username" value="{$username}" class="textCtrl OptIn" id="ctrl_username" autofocus="true" autocomplete="off" />
				<p class="explain">{xen:phrase this_is_name_that_will_be_shown_with_your_messages}</p>
			</dd>
		</dl>
	
		<dl class="ctrlUnit">
			<dt><label for="ctrl_email">{xen:phrase email}:</label></dt>
			<dd><input type="email" name="email" class="textCtrl OptIn" dir="ltr" id="ctrl_email" /></dd>
		</dl>
	
		<dl class="ctrlUnit">
			<dt><label for="ctrl_timezone">{xen:phrase time_zone}:</label></dt>
			<dd>
				<select name="timezone" class="textCtrl AutoTimeZone OptOut" id="ctrl_timezone">
					<xen:foreach loop="$timeZones" key="$identifier" value="$name">
						<option value="{$identifier}" {xen:selected "{$identifier} == {$xenOptions.guestTimeZone}"}>{$name}</option>
					</xen:foreach>
				</select>
			</dd>
		</dl>
		
		<dl class="ctrlUnit OptOut">
			<dt>{xen:phrase date_of_birth}:</dt>
			<dd>
				<xen:include template="helper_birthday_input">
					<xen:map from="$fields" to="$user" />
				</xen:include>
				<xen:if is="{$dobRequired}"><p class="explain">{xen:phrase your_date_of_birth_is_required}</p></xen:if>
			</dd>
		</dl>

		<dl class="ctrlUnit">
			<dt>{xen:phrase gender}:</dt>
			<dd>
				<ul>
					<li><label for="ctrl_gender_male"><input type="radio" name="gender" value="male" id="ctrl_gender_male" {xen:checked "{$fields.gender} == 'male'"} /> {xen:phrase male}</label></li>
					<li><label for="ctrl_gender_female"><input type="radio" name="gender" value="female" id="ctrl_gender_female" {xen:checked "{$fields.gender} == 'female'"} /> {xen:phrase female}</label></li>
					<li><label for="ctrl_gender_"><input type="radio" name="gender" value="" id="ctrl_gender_" {xen:checked "!{$fields.gender}"} /> ({xen:phrase unspecified})</label></li>
				</ul>
			</dd>
		</dl>

        <xen:include template="custom_fields_edit" />
	
		<dl class="ctrlUnit submitUnit">
			<dt></dt>
			<dd>
                <xen:if is="{$tosUrl}">
					<ul>
						<li>
							{xen:phrase i_agree_to_terms_and_rules, 'checkbox=<input type="checkbox" name="agree" value="1" id="ctrl_agree" class="Disabler" />', 'terms_attributes=href="{$tosUrl}" target="_blank"'}
							<ul id="ctrl_agree_Disabler">
								<li><input type="submit" value="{xen:phrase sign_up}" accesskey="s" class="button primary" /></li>
							</ul>						
						</li>
					</ul>
				<xen:else />
					<input type="submit" value="{xen:phrase sign_up}" accesskey="s" class="button primary" />
				</xen:if>
				
			</dd>
		</dl>
	
	</li>
	</xen:if>


	<li>
		<dl class="ctrlUnit">
			<dt><label for="ctrl_associate_login">{xen:phrase associate_with}:</label></dt>
			<dd>
				<xen:if is="{$existingUser}">
					{$existingUser.username}
					<input type="hidden" name="associate_login" value="{$existingUser.username}" />
					<input type="hidden" name="force_assoc" value="1" />
				<xen:else />
					<input type="text" name="associate_login" class="textCtrl" id="ctrl_associate_login" />
				</xen:if>
			</dd>
		</dl>
		
		<dl class="ctrlUnit">
			<dt><label for="ctrl_associate_password">{xen:phrase password}:</label></dt>
			<dd>
				<input type="password" name="associate_password" class="textCtrl" id="ctrl_associate_password" />
				<p class="explain">{xen:phrase openxbl_enter_account_password}</p>
			</dd>
		</dl>
		
		<dl class="ctrlUnit submitUnit">
			<dt></dt>
			<dd><input type="submit" value="{xen:phrase associate_account}" name="associate" accesskey="a" class="button primary" /></dd>
		</dl>
	</li>

</ul>	

<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
<input type="hidden" name="redirect" value="{$redirect}" />
<input type="hidden" name="location" value="{$location}" />
</form>
]]></template>
  </templates>
  <public_template_modifications>
    <modification template="account_external_accounts" modification_key="OpenXBLAccountExternalAccounts" description="Adds OpenXBL to the External Accounts page" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<input type="hidden" name="account" value="google" />
	</form>
</xen:if>]]></find>
      <replace><![CDATA[$0
    <xen:if is="{$xenOptions.openxblKey}">
	<form action="{xen:link account/external-accounts/disassociate}" method="post" class="xenForm">
		<h3 class="textHeading">Xbox Live</h3>
		<xen:if is="{$external.openxbl}">
			
			<xen:hook name="account_openxbl_associated">
			<dl class="ctrlUnit">
                <dt>Associated Xbox Live Account:</dt>
                <dd>
                    <div>
                    {$xbUser.gamertag}<br>
                    {$xbUser.xuid}
                    </div>
                </dd>
			</dl>
			</xen:hook>
			<dl class="ctrlUnit submitUnit">
				<dt></dt>
				<dd><ul>
                    <li>
                        <label><input type="checkbox" name="disassociate" value="1" id="ctrl_disassociate_st" class="Disabler" /> Disassociate Account</label>
                        <ul id="ctrl_disassociate_st_Disabler">
                            <li><input type="submit" class="button" value="Disassociate" /></li>
                        </ul>
                        <xen:if is="!{$hasPassword}">
                            <p class="explain">You will no longer be able to use Xbox Live Services.</p>
                        </xen:if>
                    </li>
				</ul></dd>
			</dl>
		<xen:else />
		<xen:hook name="account_openxbl_not_associated">
		<dl class="ctrlUnit">
			<dt></dt>
			<dd>You are not currently linked to any Xbox Live profile.</dd>
		</dl>
		</xen:hook>
		
		<dl class="ctrlUnit submitUnit">
			<dt></dt>
			<dd><a href="{xen:link register/openxbl, '', 'reg=1', 'assoc={$visitor.user_id}'}" class="button primary">Associate with Xbox Live</a></dd>
        </dl>
		</xen:if>

		<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
		<input type="hidden" name="_xfConfirm" value="1" />
		<input type="hidden" name="account" value="openxbl" />
	</form>
</xen:if>]]></replace>
    </modification>
    <modification template="account_wrapper" modification_key="OpenXBLAccountWrapper" description="Displays External Accounts link if OpenXBL is configured" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[{$xenOptions.googleClientId}]]></find>
      <replace><![CDATA[$0 OR {$xenOptions.openxblKey}]]></replace>
    </modification>
    <modification template="footer" modification_key="OpenXBLCopyright" description="Credits for OpenXBL" execution_order="10" enabled="1" action="callback">
      <find><![CDATA[/{xen:phrase (?:xenforo|extra)_copyright}/]]></find>
      <replace><![CDATA[OpenXBL_Listener::copyrightNotice]]></replace>
    </modification>
    <modification template="footer" modification_key="OpenXBLFooter" description="Footer CSS and JS links" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<ul class="footerLinks">]]></find>
      <replace><![CDATA[$0 
      <xen:include template="openxbl_footer" />]]></replace>
    </modification>
    <modification template="navigation_visitor_tab" modification_key="OpenXBLFriendsAccountMenu" description="Add friends list link to Account Menu" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[</strong></a></li>
					<li><a href="{xen:link account/likes}">{xen:phrase likes_youve_received}</a></li>]]></find>
      <replace><![CDATA[$0 <xen:include template="openxbl_account_menu" />]]></replace>
    </modification>
    <modification template="helper_login_form" modification_key="OpenXBLLogin" description="Displays Sign In Through Xbox Live Banner on login page" execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#<xen:if is=\"\{\$xenOptions.googleClientId\}\">(.*?)</xen:if>#si]]></find>
      <replace><![CDATA[$0
<xen:include template="openxbl_helper_login" />]]></replace>
    </modification>
    <modification template="login_bar_form" modification_key="OpenXBLLoginBarFormButton" description="Sign In Through Xbox Live Banner" execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#<xen:if is=\"\{\$xenOptions.googleClientId\}\">\n(.*?)</xen:if>#si]]></find>
      <replace><![CDATA[$0
      <xen:include template="openxbl_login_bar" />]]></replace>
    </modification>
    <modification template="login_bar_form" modification_key="OpenXBLLoginBarFormVar" description="Sets Display Variable" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if is="{$xenOptions.googleClientId}"><xen:set var="$eAuth">1</xen:set></xen:if>]]></find>
      <replace><![CDATA[$0
      <xen:if is="{$xenOptions.openxblKey}"><xen:set var="$eAuth">1</xen:set></xen:if>]]></replace>
    </modification>
    <modification template="member_view" modification_key="OpenXBLMemberView" description="Display Profile In Member View" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if is="{$canViewWarnings}">
					<dl><dt>{xen:phrase warning_points}:</dt><dd>{xen:number $user.warning_points}</dd></dl>
				</xen:if>]]></find>
      <replace><![CDATA[$0 <xen:include template="openxbl_profile_member" />]]></replace>
    </modification>
    <modification template="message" modification_key="OpenXBLMessageContent" description="Display Xbox Profile In Post Content" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<div class="messageContent">		
			<article>]]></find>
      <replace><![CDATA[<xen:include template="openxbl_profile_message" />
$0]]></replace>
    </modification>
    <modification template="message_user_info" modification_key="OpenXBLMessageUserInfo" description="Display Profile Under Avatar In Messages" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if hascontent="true">
		<div class="extraUserInfo">]]></find>
      <replace><![CDATA[<xen:include template="openxbl_profile_message_info" />
$0]]></replace>
    </modification>
    <modification template="navigation_visitor_tab" modification_key="OpenXBLNavVisitorTab" description="Displays External Accounts link if OpenXBL is configured" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[{$xenOptions.googleClientId}]]></find>
      <replace><![CDATA[$0 OR {$xenOptions.openxblKey}]]></replace>
    </modification>
    <modification template="sidebar_visitor_panel" modification_key="OpenXBLSidebarVisitorPanel" description="Display login button in the sidebar" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[{xen:phrase log_in}}</a></label>]]></find>
      <replace><![CDATA[$0
<xen:include template="openxbl_sidebar_visitor" />]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
  <bb_codes/>
</addon>
